---
- name: Install dependency packages
  hosts: all
  ignore_unreachable: true
  become: true
  tasks:
    - name: Check prerequisites
      ansible.builtin.apt:
        name:
          - git
          - make
          - golang-go
          - asciidoc
        state: present

- name: Fetch sbctl from GitHub
  hosts: all
  ignore_unreachable: true
  tasks:
    - name: Fetch sbctl repository
      git:
        repo: https://github.com/Foxboron/sbctl
        dest: "/tmp/sbctl"

- name: Build and install sbctl
  hosts: all
  ignore_unreachable: true
  become: true
  tasks:
    - name: Build sbctl
      make:
        chdir: /tmp/sbctl
        target: build
    - name: Install sbctl
      make:
        chdir: /tmp/sbctl
        target: install
